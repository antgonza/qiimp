{% import schema_builder %}
{% import metadata_package_schema_builder %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Metadata Wizard</title>
	<link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css' />
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="{{ static_url("third-party/microbiome/css/bootstrap.css") }}" rel="stylesheet" />
    <link href="{{ static_url("third-party/microbiome/css/screen.css") }}" rel="stylesheet" />

    <style type="text/css">
        .left-detail-block {
            border-right: 1px solid black;
        }
        .detail-row {
            border-top: 1px solid black;
            padding-top: 3px;
            padding-bottom: 3px;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        legend {
            color: #565656;
            font-size: medium;
            font-weight: bold;
            margin-bottom: 0;
        }
        .fieldTemplate {
            display:none;
        }
        .floating {
        }
        .field {
            padding: 2px;
            border-top: 1px solid black;
        }
        .buttons {
            padding: 2px;
            border-top: 1px solid black;
        }
    .wizard_logo {
        background: url({{ static_url("third-party/microbiome/img/logo-microbiome.png") }}) no-repeat center center;
        display: inline-block;
        width: 100px;
        height: 100px;
        margin: 25px 10px;
        background-size: 100%;
        position: relative;
        font-size: 0;
        z-index: 1;
    }
    </style>


    <!-- jquery -->
    <script src={{ static_url("third-party/jquery-3.2.1.min.js") }}></script>

    <!-- jquery validation plugin -->
    <script src={{ static_url("third-party/jquery_validation/jquery.validate.min.js") }}></script>
    <script src={{ static_url("third-party/jquery_validation/additional-methods.min.js") }}></script>

    <!-- js-yaml -->
    <script src={{ static_url("third-party/js-yaml.min.js") }}></script>

    <!-- moment (for date/time validation) -->
    <script src={{ static_url("third-party/moment.min.js") }}></script>

    <script src={{ static_url("metadataWizardHelpers.js") }}></script>
    <script src={{ static_url("metadataWizardEventHandlers.js") }}></script>
    <script src={{ static_url("packageWizard.js") }}></script>
    <script src={{ static_url("metadataWizard.js") }}></script>


    <script type="text/javascript">
        g_reserved_word_url = "{{ static_url("reserved_words.yaml") }}";
        websocket_url = "{{ websocket_url }}";

        max_selectbox_size = {{select_size}}
        text_type_value = "{{metadata_package_schema_builder.CerberusDataTypes.Text.value}}";
        no_default_radio_value = "{{schema_builder.DefaultTypes.no_default.name}}";
        SEPARATOR = "{{schema_builder.SEPARATOR}}";
        TEMPLATE_SUFFIX = "{{schema_builder.TEMPLATE_SUFFIX}}";
        field_name_regex = /{{ metadata_package_schema_builder.PerSamplePackage.FIELD_NAME_REGEX }}/

        // Note that these are to be the bases (without template suffix or separator) of form element NAMES, not IDs
        SpecialInputs = {
            FIELD_NAME: "{{schema_builder.InputNames.field_name.value}}",
            FIELD_TYPE: "{{schema_builder.InputNames.field_type.value}}",
            ALLOWED_MISSINGS: "allowed_missing_vals_fieldset",
            DATA_TYPE: "{{schema_builder.InputNames.data_type.value}}",
            TRUE_VALUE: "{{schema_builder.InputNames.true_value.value}}",
            FALSE_VALUE: "{{schema_builder.InputNames.false_value.value}}",
            MINIMUM: "{{schema_builder.InputNames.minimum_value.value}}",
            MIN_COMPARE: "{{schema_builder.InputNames.minimum_comparison.value}}",
            MAXIMUM: "{{schema_builder.InputNames.maximum_value.value}}",
            MAX_COMPARE: "{{schema_builder.InputNames.maximum_comparison.value}}",
            CATEGORY_VALS: "{{schema_builder.InputNames.categorical_values.value}}",
            DEFAULT_MISSINGS: "{{schema_builder.InputNames.allowed_missing_default_select.value}}",
            DEFAULT_OPTION: "{{schema_builder.InputNames.default_value.value}}",
            DEFAULT_CATEGORICAL: "{{schema_builder.InputNames.categorical_default_select.value}}",
            DEFAULT_BOOLEAN: "{{schema_builder.InputNames.boolean_default_select.value}}",
            DEFAULT_CONTINUOUS: "{{schema_builder.InputNames.continuous_default.value}}",
            DEFAULT_TEXT: "{{schema_builder.InputNames.text_default.value}}",
            DEFAULT_DATETIME: "{{schema_builder.InputNames.datetime_default.value}}",
            REMOVE_FIELD: "remove_field"
        };

        fields_to_show_by_field_type = {
            "":[],
            "{{schema_builder.FieldTypes.Text.value}}":["text_default_div"],
            "{{schema_builder.FieldTypes.Boolean.value}}": ["boolean_div", "allowed_missing_vals_div",
                "allowed_missing_default_div", "boolean_default_div"],
            "{{schema_builder.FieldTypes.Continuous.value}}": ["continuous_div", "allowed_missing_vals_div",
                "allowed_missing_default_div", "continuous_default_div"],
            "{{schema_builder.FieldTypes.Categorical.value}}": ["categorical_div", "allowed_missing_vals_div",
                "allowed_missing_default_div", "categorical_default_div"]
        };

        // slightly modified from https://github.com/biocore/qiita/blob/5b54aa7e445dd38b34373d9aa72481ffa7d214a4/qiita_pet/templates/sitebase.html#L82-L123
        function overlay_check() {
            // from http://stackoverflow.com/q/5916900/379593
            var ua=navigator.userAgent;
            var tem;
            var M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
            if(/trident/i.test(M[1])){
              tem=/\brv[ :]+(\d+)/g.exec(ua) || [];
              return 'IE '+(tem[1]||'');
            }
            if(M[1]==='Chrome'){
              tem=ua.match(/\bOPR\/(\d+)/);
              if(tem!=null)   {return 'Opera '+tem[1];}
            }
            M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
            if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
            objbrowserName = M[0];
            objBrMajorVersion = M[1];
            if ((objbrowserName == "Chrome"  && objBrMajorVersion < {{allowed_min_browser_versions['chrome']}})
                {% if 'firefox' in allowed_min_browser_versions %}
                  || (objbrowserName == "Firefox" && objBrMajorVersion < {{allowed_min_browser_versions['firefox']}})
                {% else %}
                  || (objbrowserName == "Firefox")
                {% end %}
                {% if 'safari' in allowed_min_browser_versions %}
                  || (objbrowserName == "Safari"  && objBrMajorVersion < {{allowed_min_browser_versions['safari']}})
                {% else %}
                  || (objbrowserName == "Safari")
                {% end %}
                {% if 'IE' in allowed_min_browser_versions %}
                  || ((objbrowserName == "IE" || objbrowserName == "MSIE") && objBrMajorVersion < {{allowed_min_browser_versions['IE']}})
                {% else %}
                  || (objbrowserName == "IE" || objbrowserName == "MSIE")
                {% end %}
              ) {
              // Show overlay because too old a browser
              ol = document.getElementById("overlay");
              ol.style.visibility = "visible";
              //navbar = document.getElementById("navigation-bar");
              //navbar.style.visibility = "hidden";
            }
          };

        function updateTypeValidation(base_name, field_index, data_type_value){
            // get the relevant input field and remove any existing validation rules related to data type (only)
            var input_id_selector = getIdSelectorFromBaseNameAndFieldIndex(base_name, field_index);
            $(input_id_selector).rules( "remove", "digits number isValidDateTime" );

            // add back any required data type validation rule
            switch (data_type_value) {
                case "{{metadata_package_schema_builder.CerberusDataTypes.Integer.value}}":
                    $(input_id_selector).rules("add", {digits: true});
                    break;
                case "{{metadata_package_schema_builder.CerberusDataTypes.Decimal.value}}":
                    $(input_id_selector).rules("add", {number: true});
                    break;
                case "{{metadata_package_schema_builder.CerberusDataTypes.DateTime.value}}":
                    $(input_id_selector).rules("add", {isValidDateTime: true});
                    break;
                case "{{metadata_package_schema_builder.CerberusDataTypes.Text.value}}":
                    // no known validation required for text; perhaps length?
                    break;
                default:
                    alert("Unexpected data type value: '" + data_type_value + "'")
            }
        }

        function enableDisableDefaultSelects(field_index, curr_val){
            enableOrDisableByValue(SpecialInputs.DEFAULT_MISSINGS, field_index, curr_val,
                    "{{schema_builder.DefaultTypes.allowed_missing_default.value}}");
            enableOrDisableByValue(SpecialInputs.DEFAULT_CATEGORICAL, field_index, curr_val,
                    "{{schema_builder.DefaultTypes.categorical_default.value}}");
            enableOrDisableByValue(SpecialInputs.DEFAULT_BOOLEAN, field_index, curr_val,
                    "{{schema_builder.DefaultTypes.boolean_default.value}}");
            enableOrDisableByValue(SpecialInputs.DEFAULT_CONTINUOUS, field_index, curr_val,
                    "{{schema_builder.DefaultTypes.continuous_default.value}}");
            enableOrDisableByValue(SpecialInputs.DEFAULT_TEXT, field_index, curr_val,
                    "{{schema_builder.DefaultTypes.text_default.value}}");
        };
    </script>
</head>
<body onload='overlay_check();'>
<form id = "package_form">
    <div class="container" id="package_div">
        <div class="row">
            <div class="col-sm-4 wizard_logo">
            </div>
            <div class="col-sm-8">
                <h1>Metadata Wizard</h1>
            </div>
        </div>
        <div class="row" id="mode_div">
            <div class="col-sm-12">
                How would you like to select your metadata package?<br />
                <input type="radio" name="metadata_mode" id = "metadata_mode_wizard" value="wizard" onchange="onModeChange(this)" required>
                <label id="metadata_mode_wizard_label" for="metadata_mode_wizard"> Use Wizard</label><br />
                <input type="radio" name="metadata_mode" id = "metadata_mode_power" value="power" onchange="onModeChange(this)">
                <label id="metadata_mode_power_label" for="metadata_mode_power"> Select Manually</label>
            </div>
        </div>
        <div class="row hidden" id="power_div">
            <div class="col-sm-12">
                <label id="package_select_label" for="package_select"> Metadata Packages:</label>
                <select name="package_select" id="package_select" size="{{select_size}}" disabled required>
                    <!-- TODO: refactor to pull from back end! -->
                    <!-- TODO: After Austin is done making packages, take out setting Generic to selected by default -->
                    <option value="other" selected="selected">Generic</option>
                </select>
            </div>
        </div>
        <div id="wizard_div" class="hidden">
            <div class="row" id="sample_type_div">
                <div class="col-sm-12">
                    <label id="sample_type_label" for="sample_type_select"> Sample Type:</label>
                    <select name="sample_type_select" id="sample_type_select" onchange="onSampleTypeChange(this)" size="{{select_size}}" disabled required>
                        <!-- TODO: refactor to pull from back end! -->
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
            <div id="environmental_div" class="hidden"></div>
            <div id="host_associated_div" class="hidden">
                <div class="row" id="host_div">
                    <div class="col-sm-12">
                        <label id="host_select_label" for="host_select"> Host Organism:</label>
                        <select name="host_select" id="host_select" onchange="checkSampleTypePlusHostImplications(this)" size="{{select_size}}" disabled required>
                            <!-- TODO: refactor to pull from back end! -->
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="row" id="host_specific_sample_type_div" >
                    <div class="col-sm-12">
                        <label id="host_sample_site_select_label" for="host_sample_site_select"> Host Sample Site:</label>
                        <select name="host_sample_site_select" id="host_sample_site_select" size="{{select_size}}" disabled required>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" id="select_package_button_div">
            <div class="col-sm-12">
                <input class="submit" type="submit" name="select_package_button" id="select_package_button"
                       value="Select Package" onsubmit="return getPackage()" disabled>
            </div>
        </div>
        <div class="row" id="package_details_div">
            <br />
            <br />
        </div>
    </div>
</form>
<form id ="metadata_form" method="post" action="" class="hidden">
    <div>
        <div class="container" id="container">
            <div class="row">
                <div class="col-sm-12">
                    <label for="{{schema_builder.InputNames.study_name.value}}"> Study Name:</label>
                    <input id="{{schema_builder.InputNames.study_name.value}}" name = "{{schema_builder.InputNames.study_name.value}}" type="text" placeholder="Study name" />
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <!-- TODO: Locale is temporarily removed because it isn't implemented yet and isn't relevant to
                    Austin's set-up of supported packages
                    <label for="study_location_select">Study City/Locale:</label>
                    <select name="study_location_select" id="study_location_select" required>
                        <option value="">--Select One--</option>
                        <option value="san_diego">San Diego, CA, USA</option>
                        <option value="other">Other</option>
                    </select>
                    -->
                    <br />
                    Enter any custom fields for your experiment below:
                </div>
            </div>
            <div class="row">
                <div class="col-sm-2"><strong>Field Name</strong></div>
                <div class="col-sm-10">
                    <div class="row">
                        <div class="col-sm-2"><strong>Field Type</strong></div>
                        <div class="col-sm-10"><strong>Field Details</strong></div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-2">
                    <select name="field_names" id="field_names" size=10 >
                        <option value="" disabled>Add a field name above</option>
                    </select>
                </div>
                <div class="col-sm-10" id="field_details_div">
                    <div class="fieldTemplate row">
                        <div class="col-sm-2">
                            <select name="{{schema_builder.InputNames.field_type.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.field_type.name}}{{schema_builder.TEMPLATE_SUFFIX}}" size={{len(schema_builder.FieldTypes)}} >
                                {% for curr_enum in schema_builder.FieldTypes %}
                                <option value="{{curr_enum.value}}">{{curr_enum.name}}</option>
                                {% end %}
                            </select>
                        </div>
                        <div class="col-sm-10">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <label for="{{schema_builder.InputNames.field_desc.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Description:</label>
                                        </div>
                                        <div class="col-sm-8">
                                            <textarea rows=4 placeholder="e.g., the age of the subject in years" name="{{schema_builder.InputNames.field_desc.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.field_desc.name}}{{schema_builder.TEMPLATE_SUFFIX}}" ></textarea>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <label for="{{schema_builder.InputNames.is_phi.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Protected Health Info:</label>
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="checkbox" name="{{schema_builder.InputNames.is_phi.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.is_phi.name}}{{schema_builder.TEMPLATE_SUFFIX}}" value="True">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 initially_hidden hidden" style="border-left: 1px solid black;" id="allowed_missing_vals_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                    <fieldset name="allowed_missing_vals_fieldset{{schema_builder.TEMPLATE_SUFFIX}}" id="allowed_missing_vals_fieldset{{schema_builder.TEMPLATE_SUFFIX}}">
                                        <legend>Allowed Missing Values (Optional)</legend>
                                        {% for curr_enum in metadata_package_schema_builder.EbiMissingValues %}
                                        <input type="checkbox" name="{{schema_builder.InputNames.allowed_missing_vals.name}}{{schema_builder.TEMPLATE_SUFFIX}}[]" id="{{schema_builder.InputNames.allowed_missing_vals.name}}_{{curr_enum.name}}{{schema_builder.TEMPLATE_SUFFIX}}" value="{{curr_enum.name}}" disabled /> {{curr_enum.value}}<br />
                                        {% end %}
                                    </fieldset>
                                </div>
                            </div>
                            <div class="initially_hidden hidden row detail-row" id="boolean_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                <div class="col-sm-6 left-detail-block">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <label for="{{schema_builder.InputNames.true_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}">True Value:</label>
                                        </div>
                                        <div class="col-sm-8">
                                            <input type ="text" name="{{schema_builder.InputNames.true_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.true_value.name}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g., Yes" disabled required/><br />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <label for="{{schema_builder.InputNames.false_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}">False Value:</label>
                                        </div>
                                        <div class="col-sm-8">
                                            <input type ="text" name="{{schema_builder.InputNames.false_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.false_value.name}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g., No" disabled required/><br />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="initially_hidden hidden row" id="continuous_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                <div class="col-sm-12">
                                    <div class="row detail-row">
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="col-sm-6 left-detail-block">
                                                    <div class="row">
                                                        <div class = "col-sm-4">
                                                            <label for="{{schema_builder.InputNames.data_type.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Data Type:</label>
                                                        </div>
                                                        <div class="col-sm-8">
                                                            <select name="{{schema_builder.InputNames.data_type.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.data_type.name}}{{schema_builder.TEMPLATE_SUFFIX}}" size="{{len(metadata_package_schema_builder.CerberusDataTypes)-1}}" disabled required>
                                                                {% for curr_enum in metadata_package_schema_builder.CerberusDataTypes %}
                                                                    {% if curr_enum is not metadata_package_schema_builder.CerberusDataTypes.Text %}
                                                                        <option value="{{curr_enum.value}}">{{curr_enum.name}}</option>
                                                                    {% end %}
                                                                {% end %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="row">
                                                        <div class = "col-sm-4">
                                                            <label for="{{schema_builder.InputNames.units.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Units:</label>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <input name="{{schema_builder.InputNames.units.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.units.name}}{{schema_builder.TEMPLATE_SUFFIX}}" type="text" placeholder="e.g., years"  disabled required/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row detail-row">
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class = "col-sm-6 left-detail-block">
                                                    <fieldset name="minimum_{{schema_builder.TEMPLATE_SUFFIX}}">
                                                        <legend>Minimum (Optional)</legend>
                                                        <div class="row">
                                                            <div class="col-sm-4">
                                                                <label for="{{schema_builder.InputNames.minimum_comparison.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Comparison</label>
                                                            </div>
                                                            <div class="col-sm-8">
                                                                <select name="{{schema_builder.InputNames.minimum_comparison.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.minimum_comparison.name}}{{schema_builder.TEMPLATE_SUFFIX}}" size="2" disabled>
                                                                    <option value="{{metadata_package_schema_builder.ValidationKeys.min_exclusive.value}}">Greater Than</option>
                                                                    <option value="{{metadata_package_schema_builder.ValidationKeys.min_inclusive.value}}">Greater Than Or Equal To</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-sm-4">
                                                                <label for="{{schema_builder.InputNames.minimum_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Value</label>
                                                            </div>
                                                            <div class="col-sm-8">
                                                                <input type ="text" name="{{schema_builder.InputNames.minimum_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.minimum_value.name}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g., 3"  disabled/>
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                                <div class="col-sm-6">
                                                    <fieldset name="minimum_{{schema_builder.TEMPLATE_SUFFIX}}">
                                                        <legend>Maximum (Optional)</legend>
                                                        <div class="row">
                                                            <div class="col-sm-4">
                                                                <label for="{{schema_builder.InputNames.maximum_comparison.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Comparison</label>
                                                            </div>
                                                            <div class="col-sm-8">
                                                                <select name="{{schema_builder.InputNames.maximum_comparison.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.maximum_comparison.name}}{{schema_builder.TEMPLATE_SUFFIX}}" size="2" disabled>
                                                                    <option value="{{metadata_package_schema_builder.ValidationKeys.max_exclusive.value}}">Less Than</option>
                                                                    <option value="{{metadata_package_schema_builder.ValidationKeys.max_inclusive.value}}">Less Than Or Equal To</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-sm-4">
                                                                <label for="{{schema_builder.InputNames.maximum_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Value</label>
                                                            </div>
                                                            <div class="col-sm-8">
                                                                <input type ="text" name="{{schema_builder.InputNames.maximum_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.maximum_value.name}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g, 10"  disabled/><br />
                                                            </div>
                                                        </div>
                                                    </fieldset>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="initially_hidden hidden row detail-row" id="categorical_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                <div class="col-sm-12">
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <label for="{{schema_builder.InputNames.categorical_values.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Categorical Values (One Per Line)</label>
                                        </div>
                                        <div class="col-sm-10">
                                            <textarea rows="5" cols="25" name="{{schema_builder.InputNames.categorical_values.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.categorical_values.name}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g., Low&#10;Medium&#10;High" disabled required></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row detail-row">
                                <div class="col-sm-6">
                                    <fieldset name="defaults{{schema_builder.TEMPLATE_SUFFIX}}">
                                        <legend>Default Value</legend>
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <input type="radio" name="{{schema_builder.InputNames.default_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id = "{{schema_builder.DefaultTypes.no_default.name}}{{schema_builder.TEMPLATE_SUFFIX}}" value="{{schema_builder.DefaultTypes.no_default.name}}" checked="checked">
                                                    </div>
                                                    <div class="col-sm-11">
                                                        <label for="no_default{{schema_builder.TEMPLATE_SUFFIX}}">No Default</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="initially_hidden hidden row" id="allowed_missing_default_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <input type="radio" name="{{schema_builder.InputNames.default_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id = "allowed_missing_default{{schema_builder.TEMPLATE_SUFFIX}}" value="allowed_missing_default">
                                                    </div>
                                                    <div class="col-sm-11">
                                                        <label for="{{schema_builder.InputNames.allowed_missing_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Allowed Missing Default</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1"></div>
                                                    <div class="col-sm-11">
                                                        <select name="{{schema_builder.InputNames.allowed_missing_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.allowed_missing_default_select.name}}{{schema_builder.TEMPLATE_SUFFIX}}" size="{{len(metadata_package_schema_builder.EbiMissingValues)}}" disabled required>
                                                            {% for curr_enum in metadata_package_schema_builder.EbiMissingValues %}
                                                            <option value="{{curr_enum.name}}" disabled>{{curr_enum.value}}</option>
                                                            {% end %}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="initially_hidden hidden row" id="categorical_default_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <input type="radio" name="{{schema_builder.InputNames.default_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id = "categorical_default{{schema_builder.TEMPLATE_SUFFIX}}" value="{{schema_builder.DefaultTypes.categorical_default.name}}">
                                                    </div>
                                                    <div class="col-sm-11">
                                                        <label id="categorical_default_label{{schema_builder.TEMPLATE_SUFFIX}}" for="{{schema_builder.InputNames.categorical_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Categorical Default</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1"></div>
                                                    <div class="col-sm-11">
                                                        <select name="{{schema_builder.InputNames.categorical_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.categorical_default_select.name}}{{schema_builder.TEMPLATE_SUFFIX}}" size="1" disabled required></select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="initially_hidden hidden row" id = "continuous_default_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <input type="radio" name="{{schema_builder.InputNames.default_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id = "continuous_default_value{{schema_builder.TEMPLATE_SUFFIX}}" value="{{schema_builder.DefaultTypes.continuous_default.name}}">
                                                    </div>
                                                    <div class="col-sm-11">
                                                        <label id="continuous_default_label{{schema_builder.TEMPLATE_SUFFIX}}" for="{{schema_builder.InputNames.continuous_default.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Continuous Default</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                        <div class="col-sm-1"></div>
                                                        <div class="col-sm-11">
                                                            <input type="text" name="{{schema_builder.InputNames.continuous_default.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.continuous_default.name}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g., 3" disabled required>
                                                        </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="initially_hidden hidden row" id = "boolean_default_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <input type="radio" name="{{schema_builder.InputNames.default_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id = "boolean_default_value{{schema_builder.TEMPLATE_SUFFIX}}" value="{{schema_builder.DefaultTypes.boolean_default.name}}">
                                                    </div>
                                                    <div class="col-sm-11">
                                                        <label id="boolean_default_label{{schema_builder.TEMPLATE_SUFFIX}}" for="{{schema_builder.InputNames.boolean_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Boolean Default</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1"></div>
                                                    <div class="col-sm-11">
                                                        <select name="{{schema_builder.InputNames.boolean_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.boolean_default_select.value}}{{schema_builder.TEMPLATE_SUFFIX}}" size="1" disabled required></select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="initially_hidden hidden row" id = "text_default_div{{schema_builder.TEMPLATE_SUFFIX}}">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <input type="radio" name="{{schema_builder.InputNames.default_value.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id = "text_default_value{{schema_builder.TEMPLATE_SUFFIX}}" value="{{schema_builder.DefaultTypes.text_default.name}}">
                                                    </div>
                                                    <div class="col-sm-4">
                                                        <label id="text_default_label{{schema_builder.TEMPLATE_SUFFIX}}" for="{{schema_builder.InputNames.text_default.value}}{{schema_builder.TEMPLATE_SUFFIX}}">Text Default</label><br />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1"></div>
                                                    <div class="col-sm-11">
                                                        <textarea name="{{schema_builder.InputNames.text_default.value}}{{schema_builder.TEMPLATE_SUFFIX}}" id="{{schema_builder.InputNames.text_default.value}}{{schema_builder.TEMPLATE_SUFFIX}}" placeholder="e.g., 0.5 ml subcutaneously" disabled required></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                            <div class="row detail-row">
                                <div class="col-sm-12">
                                   <input type="button" value="Remove Field" name="remove_field{{schema_builder.TEMPLATE_SUFFIX}}" id="remove_field{{schema_builder.TEMPLATE_SUFFIX}}">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row buttons">
            <div class="col-sm-12">
                <input class="submit" type="submit" value="Submit">&nbsp;<input type="button" value="Add Field" id="addField">
            </div>
        </div>
    </div>
</form>
<!-- slightly modified from https://github.com/biocore/qiita/blob/5b54aa7e445dd38b34373d9aa72481ffa7d214a4/qiita_pet/templates/sitebase.html#L599-L613 -->
<div id="overlay" style="visibility: hidden; position: absolute; left: 0px; top: 0px; width: 100%; height: 100%; font-size: 13px; text-align: center; z-index: 1000; background-color: #333333; color: #FFFFFF;">
  <h1>This site only works with the following browsers</h1>
  <p id="explanation"><strong>Chrome >= {{allowed_min_browser_versions['chrome']}}:</strong> You can download Chrome from <a href="https://www.google.com/chrome/browser/">here</a> or you can find instructions on how to update it <a href="https://support.google.com/chrome/answer/95414?hl=en">here</a></p>
  {% if 'safari' in allowed_min_browser_versions %}
    <p id="explanation"><strong>Safari >= {{allowed_min_browser_versions['safari']}}:</strong> You can update Safari following <a href="http://support.apple.com/en-us/HT6104">these</a> instructions.</p>
  {% end %}
  {% if 'firefox' in allowed_min_browser_versions %}
    <p id="explanation"><strong>Firefox >= {{allowed_min_browser_versions['firefox']}}:</strong> For instructions on how to install or update Firefox go <a href="https://support.mozilla.org/en-US/kb/update-firefox-latest-version">here.</a></p>
  {% end %}
  {% if 'IE' in allowed_min_browser_versions %}
    <p id="explanation"><strong>Internet Explorer >= {{allowed_min_browser_versions['IE']}}:</strong> For instructions on how to update IE go <a href="http://windows.microsoft.com/en-us/internet-explorer">here.</a></p>
  {% end %}
</div>
</body>
</html>