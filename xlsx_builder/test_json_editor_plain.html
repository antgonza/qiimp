<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Proof-of-Concept Interface for Schema Definition</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <meta charset="utf-8" />

    <script src="jsoneditor.min.js"></script>
  </head>
  <body>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <h1>Proof-of-Concept Interface For Schema Definition</h1>

    <button id='submit'>Submit (console.log)</button>
    <span id='valid_indicator'></span>

    <div id='editor_holder'></div>

    <script>
      // Initialize the editor
      var editor = new JSONEditor(document.getElementById('editor_holder'),{
        // Enable fetching schemas via ajax
        ajax: true,

        // The schema for the editor
        schema: {
  "type": "array",
  "format": "table",
  "items": {
    "title": "Metadata Field",
    "type": "object",
    "properties": {
      "Field Name": {
        "type": "string",
        "minLength": 1,
        "maxLength": 250
      },
      "kind": {
        "title": "Kind of Data",
        "type": "object",
        "oneOf": [
          {
            "title": "Boolean",
            "properties": {
              "True Value": {
                "type": "string"
              },
              "False Value": {
                "type": "string"
              }
            },
            "type": "object"
          },
          {
            "title": "Categorical",
            "properties": {
              "Allowed Values": {
                "type": "string"
              }
            },
            "type": "object"
          },
          {
            "title": "Continuous",
            "properties": {
              "number_kind": {
                "title": "Kind of Measurement",
                "type": "object",
                "anyOf": [
                  {
                    "title": "Whole Number",
                    "properties": {
                      "Minimum Value": {
                        "type": "integer"
                      },
                      "Maximum Value": {
                        "type": "integer"
                      }
                    },
                    "type": "object"
                  },
                  {
                    "title": "Decimal",
                    "properties": {
                      "Minimum Value": {
                        "type": "number"
                      },
                      "Maximum Value": {
                        "type": "number"
                      }
                    },
                    "type": "object"
                  },
                  {
                    "title": "Date/Time",
                    "properties": {
                      "Minimum Value": {
                        "type": "date-time"
                      },
                      "Maximum Value": {
                        "type": "date-time"
                      }
                    },
                    "type": "object"
                  }
                ]
              },
              "unit": {
                "title": "Unit",
                "type": "string"
              }
            },
            "type": "object"
          }
        ]
      }
    }
  }
},

        // Disable additional properties
        no_additional_properties: true,

        // Require all properties by default
        required_by_default: true,

        disable_edit_json: true,

        disable_properties: true,

        theme: "bootstrap2"
      });

      // Hook up the submit button to log to the console
      document.getElementById('submit').addEventListener('click',function() {
        // Get the value from the editor
        console.log(editor.getValue());
      });

      // Hook up the validation indicator to update its
      // status whenever the editor changes
      editor.on('change',function() {
        // Get an array of errors from the validator
        var errors = editor.validate();

        var indicator = document.getElementById('valid_indicator');

        // Not valid
        if(errors.length) {
          indicator.style.color = 'red';
          indicator.textContent = "invalid";
        }
        // Valid
        else {
          indicator.style.color = 'green';
          indicator.textContent = "valid";
        }
      });
    </script>
  </body>
</html>